<!DOCTYPE html>
<html lang="en">
  <head>
    <title>VirgilSDK  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="VirgilSDK  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">VirgilSDK 7.2.1 Docs</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">VirgilSDK Reference</a>
        <img id="carat" src="img/carat.png" />
        VirgilSDK  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/AsyncOperation.html">AsyncOperation</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/AsyncOperation/State.html">– State</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/BaseClient.html">BaseClient</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CachingJwtProvider.html">CachingJwtProvider</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CallbackJwtProvider.html">CallbackJwtProvider</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CallbackOperation.html">CallbackOperation</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Card.html">Card</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CardClient.html">CardClient</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CardManager.html">CardManager</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CardManagerParams.html">CardManagerParams</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CardSignature.html">CardSignature</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CloudEntry.html">CloudEntry</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CloudEntry/CodingKeys.html">– CodingKeys</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CloudKeyStorage.html">CloudKeyStorage</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ConstAccessTokenProvider.html">ConstAccessTokenProvider</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes.html#/c:@M@VirgilSDK@objc(cs)VSSDecryptedKeyknoxValue">DecryptedKeyknoxValue</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes.html#/c:@M@VirgilSDK@objc(cs)VSSEncryptedKeyknoxValue">EncryptedKeyknoxValue</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ExpBackoffRetry.html">ExpBackoffRetry</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ExpBackoffRetry/Config.html">– Config</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ExpBackoffRetry/ExpBackoffRetryError.html">– ExpBackoffRetryError</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/FileSystem.html">FileSystem</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/FileSystemCredentials.html">FileSystemCredentials</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/GeneratorJwtProvider.html">GeneratorJwtProvider</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/GenericOperation.html">GenericOperation</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/GetCardResponse.html">GetCardResponse</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/HttpConnection.html">HttpConnection</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Jwt.html">Jwt</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/JwtBodyContent.html">JwtBodyContent</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/JwtGenerator.html">JwtGenerator</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/JwtHeaderContent.html">JwtHeaderContent</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/JwtSignatureContent.html">JwtSignatureContent</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/KeychainEntry.html">KeychainEntry</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/KeychainQueryOptions.html">KeychainQueryOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/KeychainStorage.html">KeychainStorage</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/KeychainStorageError.html">KeychainStorageError</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/KeychainStorageParams.html">KeychainStorageParams</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/KeyknoxClient.html">KeyknoxClient</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/KeyknoxCrypto.html">KeyknoxCrypto</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/KeyknoxDeleteRecipientParams.html">KeyknoxDeleteRecipientParams</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/KeyknoxGetKeysParams.html">KeyknoxGetKeysParams</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/KeyknoxKeyEntry.html">KeyknoxKeyEntry</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/KeyknoxManager.html">KeyknoxManager</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/KeyknoxPullParams.html">KeyknoxPullParams</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/KeyknoxPushParams.html">KeyknoxPushParams</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/KeyknoxResetParams.html">KeyknoxResetParams</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/KeyknoxValue.html">KeyknoxValue</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ModelSigner.html">ModelSigner</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Mutex.html">Mutex</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/NetworkOperation.html">NetworkOperation</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/NetworkRetryOperation.html">NetworkRetryOperation</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/RawCardContent.html">RawCardContent</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/RawServiceError.html">RawServiceError</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/RawSignature.html">RawSignature</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/RawSignedModel.html">RawSignedModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Reachability.html">Reachability</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Request.html">Request</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Request/Method.html">– Method</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Response.html">Response</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SQLiteDB.html">SQLiteDB</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SQLiteError.html">SQLiteError</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SandboxedKeychainStorage.html">SandboxedKeychainStorage</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ServiceError.html">ServiceError</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ServiceRequest.html">ServiceRequest</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Statement.html">Statement</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SyncKeyStorage.html">SyncKeyStorage</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/TokenContext.html">TokenContext</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/VerifierCredentials.html">VerifierCredentials</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/VirgilAgentAdapter.html">VirgilAgentAdapter</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/VirgilCardVerifier.html">VirgilCardVerifier</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Whitelist.html">Whitelist</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/BaseClientError.html">BaseClientError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/CallbackOperationError.html">CallbackOperationError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/CardClientError.html">CardClientError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/CardManagerError.html">CardManagerError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/CloudKeyStorageError.html">CloudKeyStorageError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/DateUtils.html">DateUtils</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/GenericOperationError.html">GenericOperationError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/JwtBodyContentError.html">JwtBodyContentError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/JwtError.html">JwtError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/JwtHeaderContentError.html">JwtHeaderContentError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/JwtSignatureContentError.html">JwtSignatureContentError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/KeychainStorageErrorCodes.html">KeychainStorageErrorCodes</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/KeyknoxClientError.html">KeyknoxClientError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/KeyknoxCryptoError.html">KeyknoxCryptoError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/KeyknoxManagerError.html">KeyknoxManagerError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/Log.html">Log</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/MutexError.html">MutexError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/NetworkRetryOperationError.html">NetworkRetryOperationError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/OperationUtils.html">OperationUtils</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/RawSignedModelError.html">RawSignedModelError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/RequestError.html">RequestError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/RetryChoice.html">RetryChoice</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SQLiteBindingError.html">SQLiteBindingError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SandboxedKeychainStorageError.html">SandboxedKeychainStorageError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/ServiceConnectionError.html">ServiceConnectionError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/ServiceRequestError.html">ServiceRequestError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SyncKeyStorageError.html">SyncKeyStorageError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/VersionUtils.html">VersionUtils</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/WhitelistError.html">WhitelistError</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/Bool.html">Bool</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Data.html">Data</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Int32.html">Int32</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/String.html">String</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/AccessToken.html">AccessToken</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/AccessTokenProvider.html">AccessTokenProvider</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/CardClientProtocol.html">CardClientProtocol</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/CardVerifier.html">CardVerifier</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/CloudKeyStorageProtocol.html">CloudKeyStorageProtocol</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/DbInValue.html">DbInValue</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/DbOutValue.html">DbOutValue</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/HttpConnectionProtocol.html">HttpConnectionProtocol</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/HttpRequestAdapter.html">HttpRequestAdapter</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/KeychainStorageProtocol.html">KeychainStorageProtocol</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/KeyknoxClientProtocol.html">KeyknoxClientProtocol</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/KeyknoxCryptoProtocol.html">KeyknoxCryptoProtocol</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ReachabilityProtocol.html">ReachabilityProtocol</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/RetryProtocol.html">RetryProtocol</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <h1 id='virgil-core-sdk-objective-c-swift' class='heading'>Virgil Core SDK Objective-C/Swift</h1>

<p><a href="https://travis-ci.com/VirgilSecurity/virgil-sdk-x"><img src="https://api.travis-ci.com/VirgilSecurity/virgil-sdk-x.svg?branch=master" alt="Build Status"></a>
<a href="https://cocoapods.org/pods/VirgilSDK"><img src="https://img.shields.io/cocoapods/v/VirgilSDK.svg" alt="CocoaPods Compatible"></a>
<a href="https://github.com/Carthage/Carthage"><img src="https://img.shields.io/badge/Carthage-compatible-4BC51D.svg?style=flat" alt="Carthage compatible"></a>
<a href="https://cocoapods.org/pods/VirgilSDK"><img src="https://img.shields.io/cocoapods/p/VirgilSDK.svg?style=flat" alt="Platform"></a>
<a href="https://github.com/VirgilSecurity/virgil/blob/master/LICENSE"><img src="https://img.shields.io/badge/license-BSD%203--Clause-blue.svg" alt="GitHub license"></a></p>

<p><a href="#introduction">Introduction</a> | <a href="#sdk-features">SDK Features</a> | <a href="#installation">Installation</a> | <a href="#configure-sdk">Configure SDK</a> | <a href="#usage-examples">Usage Examples</a> | <a href="#docs">Docs</a> | <a href="#support">Support</a></p>
<h2 id='introduction' class='heading'>Introduction</h2>

<p><a href="https://developer.virgilsecurity.com/docs"><img width="230px" src="https://cdn.virgilsecurity.com/assets/images/github/logos/virgil-logo-red.png" align="left" hspace="10" vspace="6"></a> <a href="https://virgilsecurity.com">Virgil Security</a> provides a set of APIs for adding security to any application. In a few simple steps you can encrypt communications, securely store data, and ensure data integrity. Virgil Security products are available for desktop, embedded (IoT), mobile, cloud, and web applications in a variety of modern programming languages.</p>

<p>The Virgil Core SDK is a low-level library that allows developers to get up and running with <a href="https://developer.virgilsecurity.com/docs/platform/api-reference/cards-service/">Virgil Cards Service API</a> quickly and add end-to-end security to their new or existing digital solutions.</p>

<p>In case you need additional security functionality for multi-device support, group chats and more, try our high-level <a href="https://github.com/VirgilSecurity/awesome-virgil#E3Kit">Virgil E3Kit framework</a>.</p>
<h2 id='sdk-features' class='heading'>SDK Features</h2>

<ul>
<li>Communicate with <a href="https://developer.virgilsecurity.com/docs/platform/api-reference/cards-service/">Virgil Cards Service</a></li>
<li>Manage users&rsquo; public keys</li>
<li>Encrypt, sign, decrypt and verify data</li>
<li>Store private keys in secure local storage</li>
<li>Use <a href="https://github.com/VirgilSecurity/virgil-crypto-x">Virgil Crypto Library</a></li>
</ul>
<h2 id='installation' class='heading'>Installation</h2>

<p>Virgil Core SDK is provided as a set of frameworks. These frameworks are distributed via Carthage and CocoaPods. In this guide you&rsquo;ll also find one more package - Virgil Crypto Library, that is used by the SDK to perform cryptographic operations.</p>

<p>All frameworks are available for:</p>

<ul>
<li>iOS 9.0+</li>
<li>macOS 10.11+</li>
<li>tvOS 9.0+</li>
<li>watchOS 2.0+</li>
</ul>
<h3 id='cocoapods' class='heading'>COCOAPODS</h3>

<p><a href="http://cocoapods.org">CocoaPods</a> is a dependency manager for Cocoa projects. You can install it with the following command:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>gem install cocoapods
</code></pre>

<p>To integrate VirgilSDK into your Xcode project using CocoaPods, specify it in your <em>Podfile</em>:</p>
<pre class="highlight shell"><code>target <span class="s1">'&lt;Your Target Name&gt;'</span> <span class="k">do
  </span>use_frameworks!

  pod <span class="s1">'VirgilSDK'</span>, <span class="s1">'~&gt; 7.2'</span>
end
</code></pre>

<p>Then, run the following command:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>pod install
</code></pre>
<h3 id='carthage' class='heading'>Carthage</h3>

<p><a href="https://github.com/Carthage/Carthage">Carthage</a> is a decentralized dependency manager that builds your dependencies and provides you with binary frameworks.</p>

<p>You can install Carthage with <a href="http://brew.sh/">Homebrew</a> using the following command:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>brew update
<span class="gp">$ </span>brew install carthage
</code></pre>

<p>To integrate VirgilSDK into your Xcode project using Carthage, create an empty file with name <em>Cartfile</em> in your project&rsquo;s root folder and add following lines to your <em>Cartfile</em></p>
<pre class="highlight plaintext"><code>github "VirgilSecurity/virgil-sdk-x" ~&gt; 7.2
</code></pre>
<h4 id='linking-against-prebuilt-binaries' class='heading'>Linking against prebuilt binaries</h4>

<p>To link prebuilt frameworks to your app, run following command:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>carthage update --no-use-binaries
</code></pre>

<p>This will build each dependency or download a pre-compiled framework from github Releases.</p>
<h5 id='building-for-ios-tvos-watchos' class='heading'>Building for iOS/tvOS/watchOS</h5>

<p>On your application targets’ “General” settings tab, in the “Linked Frameworks and Libraries” section, add following frameworks from the <em>Carthage/Build</em> folder inside your project&rsquo;s folder:</p>

<ul>
<li>VirgilSDK</li>
<li>VirgilCrypto</li>
<li>VirgilCryptoFoundation</li>
<li>VSCCommon</li>
<li>VSCFoundation</li>
</ul>

<p>On your application targets’ “Build Phases” settings tab, click the “+” icon and choose “New Run Script Phase.” Create a Run Script in which you specify your shell (ex: <em>/bin/sh</em>), add the following contents to the script area below the shell:</p>
<pre class="highlight shell"><code>/usr/local/bin/carthage copy-frameworks
</code></pre>

<p>and add the paths to the frameworks you want to use under “Input Files”, e.g.:</p>
<pre class="highlight plaintext"><code>$(SRCROOT)/Carthage/Build/iOS/VirgilSDK.framework
$(SRCROOT)/Carthage/Build/iOS/VirgilCrypto.framework
$(SRCROOT)/Carthage/Build/iOS/VirgilCryptoFoundation.framework
$(SRCROOT)/Carthage/Build/iOS/VSCCommon.framework
$(SRCROOT)/Carthage/Build/iOS/VSCFoundation.framework
</code></pre>
<h5 id='building-for-macos' class='heading'>Building for macOS</h5>

<p>On your application target&rsquo;s “General” settings tab, in the “Embedded Binaries” section, drag and drop following frameworks from the Carthage/Build folder on disk:</p>

<ul>
<li>VirgilSDK</li>
<li>VirgilCrypto</li>
<li>VirgilCryptoFoundation</li>
<li>VSCCommon</li>
<li>VSCFoundation</li>
</ul>

<p>Additionally, you&rsquo;ll need to copy debug symbols for debugging and crash reporting on macOS.</p>

<p>On your application target’s “Build Phases” settings tab, click the “+” icon and choose “New Copy Files Phase”.
Click the “Destination” drop-down menu and select “Products Directory”. For each framework, drag and drop corresponding dSYM file.</p>
<h2 id='configure-sdk' class='heading'>Configure SDK</h2>

<p>This section contains guides on how to set up Virgil Core SDK modules for authenticating users, managing Virgil Cards and storing private keys.</p>
<h3 id='set-up-authentication' class='heading'>Set up authentication</h3>

<p>Set up user authentication with tokens that are based on the <a href="https://jwt.io/">JSON Web Token standard</a> with some Virgil modifications.</p>

<p>In order to make calls to Virgil Services (for example, to publish user&rsquo;s Card on Virgil Cards Service), you need to have a JSON Web Token (&ldquo;JWT&rdquo;) that contains the user&rsquo;s <code>identity</code>, which is a string that uniquely identifies each user in your application.</p>

<p>Credentials that you&rsquo;ll need:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>App ID</td>
<td>ID of your Application at <a href="https://dashboard.virgilsecurity.com">Virgil Dashboard</a></td>
</tr>
<tr>
<td>App Key ID</td>
<td>A unique string value that identifies your account at the Virgil developer portal</td>
</tr>
<tr>
<td>App Key</td>
<td>A Private Key that is used to sign API calls to Virgil Services. For security, you will only be shown the App Key when the key is created. Don&rsquo;t forget to save it in a secure location for the next step</td>
</tr>
</tbody></table>
<h4 id='set-up-jwt-provider-on-client-side' class='heading'>Set up JWT provider on Client side</h4>

<p>Use these lines of code to specify which JWT generation source you prefer to use in your project:</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">VirgilSDK</span>

<span class="c1">// Get generated token from server-side</span>
<span class="k">let</span> <span class="nv">authenticatedQueryToServerSide</span><span class="p">:</span> <span class="p">((</span><span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="o">=</span> <span class="p">{</span> <span class="n">completion</span> <span class="k">in</span>
    <span class="nf">completion</span><span class="p">(</span><span class="s">"eyJraWQiOiI3MGI0NDdlMzIxZj....MK7p7Ak"</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// Setup AccessTokenProvider</span>
<span class="k">let</span> <span class="nv">accessTokenProvider</span> <span class="o">=</span> <span class="kt">CallbackJwtProvider</span> <span class="p">{</span> <span class="n">tokenContext</span><span class="p">,</span> <span class="n">completion</span> <span class="k">in</span>
    <span class="n">authenticatedQueryToServerSide</span> <span class="p">{</span> <span class="n">jwtString</span> <span class="k">in</span>
        <span class="nf">completion</span><span class="p">(</span><span class="n">jwtString</span><span class="p">,</span> <span class="kc">nil</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h4 id='generate-jwt-on-server-side' class='heading'>Generate JWT on Server side</h4>

<p>For this subsection we&rsquo;ve created a sample backend that demonstrates how you can set up your backend to generate the JWTs. To set up and run the sample backend locally, head over to your GitHub repo of choice:</p>

<p><a href="https://github.com/VirgilSecurity/sample-backend-nodejs">Node.js</a> | <a href="https://github.com/VirgilSecurity/sample-backend-go">Golang</a> | <a href="https://github.com/VirgilSecurity/sample-backend-php">PHP</a> | <a href="https://github.com/VirgilSecurity/sample-backend-java">Java</a> | <a href="https://github.com/VirgilSecurity/virgil-sdk-python/tree/master#sample-backend-for-jwt-generation">Python</a>
 and follow the instructions in README.</p>
<h3 id='set-up-card-verifier' class='heading'>Set up Card Verifier</h3>

<p>Virgil Card Verifier helps you automatically verify signatures of a user&rsquo;s Card, for example when you get a Card from Virgil Cards Service.</p>

<p>By default, <code><a href="Classes/VirgilCardVerifier.html">VirgilCardVerifier</a></code> verifies only two signatures - those of a Card owner and Virgil Cards Service.</p>

<p>Set up <code><a href="Classes/VirgilCardVerifier.html">VirgilCardVerifier</a></code> with the following lines of code:</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">VirgilSDK</span>
<span class="kd">import</span> <span class="kt">VirgilCrypto</span>

<span class="c1">// initialize Crypto library</span>
<span class="k">let</span> <span class="nv">cardCrypto</span> <span class="o">=</span> <span class="kt">VirgilCardCrypto</span><span class="p">()</span>

<span class="k">let</span> <span class="nv">yourBackendVerifierCredentials</span> <span class="o">=</span>
    <span class="kt">VerifierCredentials</span><span class="p">(</span><span class="nv">signer</span><span class="p">:</span> <span class="s">"YOUR_BACKEND"</span><span class="p">,</span>
                        <span class="nv">publicKey</span><span class="p">:</span> <span class="kt">Data</span><span class="p">(</span><span class="nv">base64Encoded</span><span class="p">:</span> <span class="n">publicKeyStr</span><span class="p">)</span><span class="o">!</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">yourBackendWhitelist</span> <span class="o">=</span>
    <span class="k">try!</span> <span class="kt">Whitelist</span><span class="p">(</span><span class="nv">verifiersCredentials</span><span class="p">:</span> <span class="p">[</span><span class="n">yourBackendVerifierCredentials</span><span class="p">])</span>

<span class="k">let</span> <span class="nv">cardVerifier</span> <span class="o">=</span> <span class="kt">VirgilCardVerifier</span><span class="p">(</span><span class="nv">cardCrypto</span><span class="p">:</span> <span class="n">cardCrypto</span><span class="p">,</span>
                                      <span class="nv">whitelists</span><span class="p">:</span> <span class="p">[</span><span class="n">yourBackendWhitelist</span><span class="p">])</span>

</code></pre>
<h3 id='set-up-card-manager' class='heading'>Set up Card Manager</h3>

<p>This subsection shows how to set up a Card Manager module to help you manage users&rsquo; public keys.</p>

<p>With Card Manager you can:</p>

<ul>
<li>specify an access Token (JWT) Provider.</li>
<li>specify a Card Verifier used to verify signatures of your users, your App Server, Virgil Services (optional).</li>
</ul>

<p>Use the following lines of code to set up the Card Manager:</p>
<pre class="highlight swift"><code><span class="c1">// initialize cardManager and specify accessTokenProvider, cardVerifier</span>
<span class="k">let</span> <span class="nv">cardManagerParams</span> <span class="o">=</span> <span class="kt">CardManagerParams</span><span class="p">(</span><span class="nv">cardCrypto</span><span class="p">:</span> <span class="n">cardCrypto</span><span class="p">,</span>
                                          <span class="nv">accessTokenProvider</span><span class="p">:</span> <span class="n">accessTokenProvider</span><span class="p">,</span>
                                          <span class="nv">cardVerifier</span><span class="p">:</span> <span class="n">cardVerifier</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">cardManager</span> <span class="o">=</span> <span class="kt">CardManager</span><span class="p">(</span><span class="nv">params</span><span class="p">:</span> <span class="n">cardManagerParams</span><span class="p">)</span>
</code></pre>
<h2 id='usage-examples' class='heading'>Usage Examples</h2>

<p>Before you start practicing with the usage examples, make sure that the SDK is configured. See the <a href="#configure-sdk">Configure SDK</a> section for more information.</p>
<h3 id='generate-and-publish-virgil-cards-at-cards-service' class='heading'>Generate and publish Virgil Cards at Cards Service</h3>

<p>Use the following lines of code to create a user&rsquo;s Card with a public key inside and publish it at Virgil Cards Service:</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">VirgilSDK</span>
<span class="kd">import</span> <span class="kt">VirgilCrypto</span>

<span class="c1">// save a private key into key storage</span>
<span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="k">try!</span> <span class="n">crypto</span><span class="o">.</span><span class="nf">exportPrivateKey</span><span class="p">(</span><span class="n">keyPair</span><span class="o">.</span><span class="n">privateKey</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">entry</span> <span class="o">=</span> <span class="k">try!</span> <span class="n">keychainStorage</span><span class="o">.</span><span class="nf">store</span><span class="p">(</span><span class="nv">data</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span> <span class="nv">withName</span><span class="p">:</span> <span class="s">"Alice"</span><span class="p">,</span> <span class="nv">meta</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>

<span class="c1">// publish user's card on the Cards Service</span>
<span class="n">cardManager</span><span class="o">.</span><span class="nf">publishCard</span><span class="p">(</span><span class="nv">privateKey</span><span class="p">:</span> <span class="n">keyPair</span><span class="o">.</span><span class="n">privateKey</span><span class="p">,</span> <span class="nv">publicKey</span><span class="p">:</span> <span class="n">keyPair</span><span class="o">.</span><span class="n">publicKey</span><span class="p">)</span><span class="o">.</span><span class="n">start</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
        <span class="c1">// Card is created</span>
        <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">card</span><span class="p">):</span> <span class="k">break</span>
        <span class="c1">// Error occured</span>
        <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span> <span class="k">break</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h3 id='sign-then-encrypt-data' class='heading'>Sign then encrypt data</h3>

<p>Virgil Core SDK allows you to use a user&rsquo;s private key and their Virgil Cards to sign and encrypt any kind of data.</p>

<p>In the following example, we load a private key from a customized key storage and get recipient&rsquo;s Card from the Virgil Cards Service. Recipient&rsquo;s Card contains a public key which we will use to encrypt the data and verify a signature.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">VirgilSDK</span>
<span class="kd">import</span> <span class="kt">VirgilCrypto</span>

<span class="c1">// prepare a message</span>
<span class="k">let</span> <span class="nv">messageToEncrypt</span> <span class="o">=</span> <span class="s">"Hello, Bob!"</span>
<span class="k">let</span> <span class="nv">dataToEncrypt</span> <span class="o">=</span> <span class="n">messageToEncrypt</span><span class="o">.</span><span class="nf">data</span><span class="p">(</span><span class="nv">using</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span><span class="o">!</span>

<span class="c1">// prepare a user's private key</span>
<span class="k">let</span> <span class="nv">alicePrivateKeyEntry</span> <span class="o">=</span> <span class="k">try!</span> <span class="n">keychainStorage</span><span class="o">.</span><span class="nf">retrieveEntry</span><span class="p">(</span><span class="nv">withName</span><span class="p">:</span> <span class="s">"Alice"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">alicePrivateKey</span> <span class="o">=</span> <span class="k">try!</span> <span class="n">crypto</span><span class="o">.</span><span class="nf">importPrivateKey</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">alicePrivateKeyEntry</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="c1">// using cardManager search for user's cards on Cards Service</span>
<span class="n">cardManager</span><span class="o">.</span><span class="nf">searchCards</span><span class="p">(</span><span class="nv">identities</span><span class="p">:</span> <span class="p">[</span><span class="s">"Bob"</span><span class="p">])</span><span class="o">.</span><span class="n">start</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
    <span class="c1">// Cards are obtained</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">cards</span><span class="p">):</span>
        <span class="k">let</span> <span class="nv">bobRelevantCardsPublicKeys</span> <span class="o">=</span> <span class="n">cards</span>
            <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">publicKey</span> <span class="p">}</span>

        <span class="c1">// sign a message with a private key then encrypt on a public key</span>
        <span class="k">let</span> <span class="nv">encryptedData</span> <span class="o">=</span> <span class="k">try!</span> <span class="n">crypto</span><span class="o">.</span><span class="nf">signAndEncrypt</span><span class="p">(</span><span class="n">dataToEncrypt</span><span class="p">,</span>
                                                       <span class="nv">with</span><span class="p">:</span> <span class="n">alicePrivateKey</span><span class="p">,</span>
                                                       <span class="nv">for</span><span class="p">:</span> <span class="n">bobRelevantCardsPublicKeys</span><span class="p">)</span>

    <span class="c1">// Error occured</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span> <span class="k">break</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h3 id='decrypt-data-and-verify-signature' class='heading'>Decrypt data and verify signature</h3>

<p>Once the user receives the signed and encrypted message, they can decrypt it with their own private key and verify the signature with the sender&rsquo;s Card:</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">VirgilSDK</span>
<span class="kd">import</span> <span class="kt">VirgilCrypto</span>

<span class="c1">// prepare a user's private key</span>
<span class="k">let</span> <span class="nv">bobPrivateKeyEntry</span> <span class="o">=</span> <span class="k">try!</span> <span class="n">keychainStorage</span><span class="o">.</span><span class="nf">retrieveEntry</span><span class="p">(</span><span class="nv">withName</span><span class="p">:</span> <span class="s">"Bob"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">bobPrivateKey</span> <span class="o">=</span> <span class="k">try!</span> <span class="n">exporter</span><span class="o">.</span><span class="nf">importPrivateKey</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">bobPrivateKeyEntry</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="c1">// using cardManager search for user's cards on Cards Service</span>
<span class="n">cardManager</span><span class="o">.</span><span class="nf">searchCards</span><span class="p">(</span><span class="nv">identities</span><span class="p">:</span> <span class="p">[</span><span class="s">"Alice"</span><span class="p">])</span><span class="o">.</span><span class="n">start</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
    <span class="c1">// Cards are obtained</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">cards</span><span class="p">):</span>
        <span class="k">let</span> <span class="nv">aliceRelevantCardsPublicKeys</span> <span class="o">=</span> <span class="n">cards</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">publicKey</span> <span class="p">}</span>

        <span class="c1">// decrypt with a private key and verify using a public key</span>
        <span class="k">let</span> <span class="nv">decryptedData</span> <span class="o">=</span> <span class="k">try!</span> <span class="n">crypto</span><span class="o">.</span><span class="nf">decryptAndVerify</span><span class="p">(</span><span class="n">encryptedData</span><span class="p">,</span> 
                                                         <span class="nv">with</span><span class="p">:</span> <span class="n">bobPrivateKey</span><span class="p">,</span>
                                                         <span class="nv">usingOneOf</span><span class="p">:</span> <span class="n">aliceRelevantCardsPublicKeys</span><span class="p">)</span>

    <span class="c1">// Error occured</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span> <span class="k">break</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h3 id='get-card-by-its-id' class='heading'>Get Card by its ID</h3>

<p>Use the following lines of code to get a user&rsquo;s card from Virgil Cloud by its ID:</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">VirgilSDK</span>

<span class="c1">// using cardManager get a user's card from the Cards Service</span>
<span class="n">cardManager</span><span class="o">.</span><span class="nf">getCard</span><span class="p">(</span><span class="nv">withId</span><span class="p">:</span> <span class="s">"f4bf9f7fcbedaba0392f108c59d8f4a38b3838efb64877380171b54475c2ade8"</span><span class="p">)</span><span class="o">.</span><span class="n">start</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
    <span class="c1">// Card is obtained</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">card</span><span class="p">):</span> <span class="k">break</span>
    <span class="c1">// Error occurred</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span> <span class="k">break</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h3 id='get-card-by-user-39-s-identity' class='heading'>Get Card by user&rsquo;s identity</h3>

<p>For a single user, use the following lines of code to get a user&rsquo;s Card by a user&rsquo;s <code>identity</code>:</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">VirgilSDK</span>

<span class="c1">// using cardManager search for user's cards on Cards Service</span>
<span class="n">cardManager</span><span class="o">.</span><span class="nf">searchCards</span><span class="p">(</span><span class="nv">identity</span><span class="p">:</span> <span class="s">"Bob"</span><span class="p">)</span><span class="o">.</span><span class="n">start</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
    <span class="c1">// Cards are obtained</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">cards</span><span class="p">):</span> <span class="k">break</span>
    <span class="c1">// Error occurred</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span> <span class="k">break</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h3 id='revoke-card' class='heading'>Revoke Card</h3>

<p>You can revoke user&rsquo;s Card in case they don&rsquo;t need it anymore. Revoked Card can still be obtained using its identifier, but this card won&rsquo;t appear during search query.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">VirgilSDK</span>

<span class="k">let</span> <span class="nv">result</span> <span class="o">=</span> <span class="n">cardManager</span><span class="o">.</span><span class="nf">revokeCard</span><span class="p">(</span><span class="nv">withId</span><span class="p">:</span> <span class="n">card</span><span class="o">.</span><span class="n">identifier</span><span class="p">)</span><span class="o">.</span><span class="n">start</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
        <span class="c1">// Card is revoked</span>
        <span class="k">case</span> <span class="o">.</span><span class="nv">success</span><span class="p">:</span> <span class="k">break</span>
        <span class="c1">// Error occured</span>
        <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span> <span class="k">break</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h3 id='generate-key-pair-using-virgilcrypto' class='heading'>Generate key pair using VirgilCrypto</h3>

<p>You can generate a key pair and save it in a secure key storage with the following code:</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">VirgilCrypto</span>

<span class="k">let</span> <span class="nv">crypto</span> <span class="o">=</span> <span class="k">try!</span> <span class="kt">VirgilCrypto</span><span class="p">()</span>

<span class="k">let</span> <span class="nv">keyPair</span> <span class="o">=</span> <span class="k">try!</span> <span class="n">crypto</span><span class="o">.</span><span class="nf">generateKeyPair</span><span class="p">()</span>
</code></pre>
<h3 id='save-and-retrieve-key-using-keychain-storage' class='heading'>Save and retrieve key using keychain storage</h3>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">VirgilSDK</span>
<span class="kd">import</span> <span class="kt">VirgilCrypto</span>

<span class="k">let</span> <span class="nv">storageParams</span> <span class="o">=</span> <span class="k">try!</span> <span class="kt">KeychainStorageParams</span><span class="o">.</span><span class="nf">makeKeychainStorageParams</span><span class="p">()</span>
<span class="k">let</span> <span class="nv">keychainStorage</span> <span class="o">=</span> <span class="kt">KeychainStorage</span><span class="p">(</span><span class="nv">storageParams</span><span class="p">:</span> <span class="n">storageParams</span><span class="p">)</span>

<span class="c1">// export key to Data</span>
<span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="k">try!</span> <span class="n">crypto</span><span class="o">.</span><span class="nf">exportPrivateKey</span><span class="p">(</span><span class="n">keyPair</span><span class="o">.</span><span class="n">privateKey</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">identity</span> <span class="o">=</span> <span class="s">"Alice"</span>

<span class="c1">// save key data</span>
<span class="k">let</span> <span class="nv">entry</span> <span class="o">=</span> <span class="k">try!</span> <span class="n">keychainStorage</span><span class="o">.</span><span class="nf">store</span><span class="p">(</span><span class="nv">data</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span> <span class="nv">withName</span><span class="p">:</span> <span class="n">identity</span><span class="p">,</span> <span class="nv">meta</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>

<span class="c1">// retrieve key data</span>
<span class="k">let</span> <span class="nv">retrievedEntry</span> <span class="o">=</span> <span class="k">try!</span> <span class="n">keychainStorage</span><span class="o">.</span><span class="nf">retrieveEntry</span><span class="p">(</span><span class="nv">withName</span><span class="p">:</span> <span class="n">identity</span><span class="p">)</span>

<span class="c1">// import key from Data</span>
<span class="k">let</span> <span class="nv">privateKey</span> <span class="o">=</span> <span class="k">try!</span> <span class="n">exporter</span><span class="o">.</span><span class="nf">importPrivateKey</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">retrievedEntry</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</code></pre>
<h2 id='docs' class='heading'>Docs</h2>

<p>Virgil Security has a powerful set of APIs, and the <a href="https://developer.virgilsecurity.com/">Developer Documentation</a> can get you started today.</p>
<h2 id='license' class='heading'>License</h2>

<p>This library is released under the <a href="LICENSE">3-clause BSD License</a>.</p>
<h2 id='support' class='heading'>Support</h2>

<p>Our developer support team is here to help you. Find out more information on our <a href="https://help.virgilsecurity.com/">Help Center</a>.</p>

<p>You can find us on <a href="https://twitter.com/VirgilSecurity">Twitter</a> or send us email <a href="mailto:support@VirgilSecurity.com">support@VirgilSecurity.com</a>.</p>

<p>Also, get extra help from our support team on <a href="https://virgilsecurity.com/join-community">Slack</a>.</p>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2020 <a class="link" href="https://virgilsecurity.com/" target="_blank" rel="external">Virgil Security</a>. All rights reserved. (Last updated: 2020-05-21)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.13.3</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
